---
import joshAvatar from '../assets/testimonial_josh.jpg';
import manseeAvatar from '../assets/testimonial_mansee.jpg';
import davidAvatar from '../assets/testimonial_david.jpg';
import patriceAvatar from '../assets/testimonial_patrice.jpg';

interface Testimonial {
	name: string;
	title: string;
	company: string;
	text: string;
	imageSrc?: string;
}

const testimonials: Testimonial[] = [
	{
		name: "Josh Dyson",
		title: "VP of Design",
		company: "Marketplacer",
		text: "Patrick brought an exceptional skill set and depth of expertise to Marketplacer, consistently adding meaningful value across multiple areas of the business. He is a true professional, highly capable, engaged and reliable. Patrick excels in stakeholder management and brings a warm, charismatic presence to user research, enabling him to build trust quickly and extract genuine insights. His strong eye for detail, design thinking capacity and ability to connect strategy with execution made him an invaluable contributor to every squad he worked with.",
		imageSrc: joshAvatar.src,
	},
	{
		name: "Mansee Sheth",
		title: "Product Manager",
		company: "Marketplacer",
		text: "I highly recommend Patrick. He was instrumental in shaping the one of the key initiative within marketplace experience, particularly from the Seller and Operator perspective. Patrick consistently factored in the complex end-to-end user journey, ensuring a seamless experience. His ability to deliver a strong MVP while keeping the bigger product vision in mind, all while embedding our design system, was key to get stakeholders aligned and success of key features of the product.",
		imageSrc: manseeAvatar.src,
	},
    {
		name: "David Misfeld",
		title: "Senior Experience Designer",
		company: "PageUp",
		text: "I had the pleasure of working alongside Patrick on several product design projects for our SaaS software, and I was consistently impressed by his expertise and adaptability. Patrick is a fast learner who quickly integrated himself into new projects and teams, contributing valuable insights from the start. His deep understanding of Design Thinking and ability to apply it practically to solve complex SaaS challenges made him an indispensable part of our design process. Patrick also demonstrated a strong command of Design Systems, with significant knowledge of front-end code that allowed him to collaborate seamlessly with development teams. Patrick's UI design skills are outstanding, and he consistently delivered screen designs that were not only visually appealing but also aligned perfectly with our users' needs and Jobs-to-be-Done. I highly recommend Patrick for any UXUI design role - he's a talented designer and a fantastic team player.",
		imageSrc: davidAvatar.src,
	},
    {
		name: "Patrice Lecaros",
		title: "UX Designer",
		company: "Mochi",
		text: "I had the pleasure of working alongside Patrick on several product design projects for our SaaS software, and I was consistently impressed by his expertise and adaptability. Patrick is a fast learner who quickly integrated himself into new projects and teams, contributing valuable insights from the start. His deep understanding of Design Thinking and ability to apply it practically to solve complex SaaS challenges made him an indispensable part of our design process. Patrick also demonstrated a strong command of Design Systems, with significant knowledge of front-end code that allowed him to collaborate seamlessly with development teams. Patrick's UI design skills are outstanding, and he consistently delivered screen designs that were not only visually appealing but also aligned perfectly with our users' needs and Jobs-to-be-Done. I highly recommend Patrick for any UXUI design role - he's a talented designer and a fantastic team player.",
		imageSrc: patriceAvatar.src,
	}
	// Add more testimonials here as needed
];
---

<section id="testimonials" class="w-full max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12 lg:py-16 xl:py-20">
	<h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-6 sm:mb-8 lg:mb-12">Testimonials</h2>
	
	<div class="relative overflow-hidden" id="testimonials-container">
		<!-- Carousel Container -->
		<div class="relative overflow-hidden">
			<div 
				id="testimonials-carousel"
				class="flex"
			>
				<!-- First set of testimonials -->
				{testimonials.map((testimonial, index) => (
					<div 
						class="min-w-[85%] sm:min-w-[400px] md:min-w-[50%] px-2 sm:px-4"
						data-index={index}
					>
						<div class="bg-white rounded-xl sm:rounded-2xl border border-slate-200 p-4 sm:p-6 lg:p-8 shadow-sm w-full max-w-[320px] sm:max-w-[500px] md:max-w-[600px] mx-auto">
							<div class="flex items-start gap-3 sm:gap-4 md:gap-6 mb-3 sm:mb-4 md:mb-6">
								<!-- Profile Picture -->
								<div class="w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 rounded-full bg-slate-200 shrink-0 flex items-center justify-center overflow-hidden">
									{testimonial.imageSrc ? (
										<img 
											src={testimonial.imageSrc} 
											alt={testimonial.name}
											class="w-full h-full object-cover"
										/>
									) : (
										<div class="w-full h-full bg-slate-300"></div>
									)}
								</div>
								
								<!-- Name and Title -->
								<div class="flex-1 min-w-0">
									<h3 class="text-base sm:text-lg md:text-xl font-bold text-slate-900 mb-0.5 sm:mb-1">
										{testimonial.name}
									</h3>
									<p class="text-xs sm:text-sm md:text-base text-slate-600 leading-tight">
										{testimonial.title} @ {testimonial.company}
									</p>
								</div>
							</div>
							
							<!-- Testimonial Text -->
							<blockquote class="text-sm sm:text-base md:text-lg text-slate-700 leading-relaxed">
								"{testimonial.text}"
							</blockquote>
						</div>
					</div>
				))}
				
				<!-- Duplicate set for seamless loop -->
				{testimonials.map((testimonial, index) => (
					<div 
						class="min-w-[85%] sm:min-w-[400px] md:min-w-[50%] px-2 sm:px-4"
						data-index={index + testimonials.length}
					>
						<div class="bg-white rounded-xl sm:rounded-2xl border border-slate-200 p-4 sm:p-6 lg:p-8 shadow-sm w-full max-w-[320px] sm:max-w-[500px] md:max-w-[600px] mx-auto">
							<div class="flex items-start gap-3 sm:gap-4 md:gap-6 mb-3 sm:mb-4 md:mb-6">
								<!-- Profile Picture -->
								<div class="w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 rounded-full bg-slate-200 shrink-0 flex items-center justify-center overflow-hidden">
									{testimonial.imageSrc ? (
										<img 
											src={testimonial.imageSrc} 
											alt={testimonial.name}
											class="w-full h-full object-cover"
										/>
									) : (
										<div class="w-full h-full bg-slate-300"></div>
									)}
								</div>
								
								<!-- Name and Title -->
								<div class="flex-1 min-w-0">
									<h3 class="text-base sm:text-lg md:text-xl font-bold text-slate-900 mb-0.5 sm:mb-1">
										{testimonial.name}
									</h3>
									<p class="text-xs sm:text-sm md:text-base text-slate-600 leading-tight">
										{testimonial.title} @ {testimonial.company}
									</p>
								</div>
							</div>
							
							<!-- Testimonial Text -->
							<blockquote class="text-sm sm:text-base md:text-lg text-slate-700 leading-relaxed">
								"{testimonial.text}"
							</blockquote>
						</div>
					</div>
				))}
			</div>
			
			<!-- Left gradient fade -->
			<div class="hidden md:block absolute left-0 top-0 bottom-0 w-24 md:w-24 bg-linear-to-r from-white to-transparent z-10 pointer-events-none"></div>
			
			<!-- Right gradient fade -->
			<div class="hidden md:block absolute right-0 top-0 bottom-0 w-24 md:w-24 bg-linear-to-l from-white to-transparent z-10 pointer-events-none"></div>
		</div>
	</div>
</section>

<script>
	if (typeof window !== 'undefined') {
		window.addEventListener('DOMContentLoaded', () => {
			const carousel = document.getElementById('testimonials-carousel');
			const container = document.getElementById('testimonials-container');
			
			if (!carousel || !container) return;
			
			const testimonials = carousel.querySelectorAll('[data-index]');
			if (testimonials.length <= 1) return;
			
			// Check if we're on mobile (showing 1 card) or desktop (showing 2 cards)
			const getCardsPerView = (): number => {
				return window.innerWidth >= 768 ? 2 : 1;
			};
			
			let animationId: number;
			let isPaused = false;
			let position = 0;
			const desktopSpeed = 0.03; // pixels per frame for desktop
			const mobileSpeed = 0.1; // pixels per frame for mobile (2x faster)
			
			const getSpeed = (): number => {
				return window.innerWidth >= 768 ? desktopSpeed : mobileSpeed;
			};
			
			const animate = () => {
				if (!isPaused) {
					const cardsPerView = getCardsPerView();
					const cardWidth = 100 / cardsPerView; // percentage width per card
					const totalCards = testimonials.length / 2; // Only count first set (duplicates are for seamless loop)
					const maxPosition = totalCards * cardWidth; // Total width of first set
					const speed = getSpeed();
					
					position += speed;
					
					// Reset position when we've scrolled through the first set
					if (position >= maxPosition) {
						position = 0;
					}
					
					carousel.style.transform = `translateX(-${position}%)`;
				}
				
				animationId = requestAnimationFrame(animate);
			};
			
			// Pause on hover
			container.addEventListener('mouseenter', () => {
				isPaused = true;
			});
			
			container.addEventListener('mouseleave', () => {
				isPaused = false;
			});
			
			// Pause on touch (mobile)
			container.addEventListener('touchstart', () => {
				isPaused = true;
			});
			
			container.addEventListener('touchend', () => {
				// Resume after a short delay
				setTimeout(() => {
					isPaused = false;
				}, 2000);
			});
			
			// Handle window resize
			let resizeTimeout: number;
			window.addEventListener('resize', () => {
				window.clearTimeout(resizeTimeout);
				resizeTimeout = window.setTimeout(() => {
					// Reset position on resize to prevent visual glitches
					position = 0;
				}, 150);
			});
			
			// Start animation
			animate();
		});
	}
</script>

<style>
	#testimonials-carousel {
		display: flex;
		will-change: transform;
	}
	
	#testimonials-carousel > div {
		flex-shrink: 0;
	}
	
	#testimonials-container {
		cursor: default;
	}
</style>

